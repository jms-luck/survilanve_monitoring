<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Start Attendance</title>
    <link rel="stylesheet" href="./assets/css/styles.css">
</head>
<body>
    <nav class="menubar">
        <ul>
            <li><a href="registration.html">Registration</a></li>
            <li><a href="attendance.html">Attendance</a></li>
            <li><a href="report.html">Report</a></li>
            <li><a href="startattendance.html" class="active">Start Attendance</a></li>
        </ul>
    </nav>
    <div class="container">
        <h1>Start Attendance</h1>
        <form id="start-attendance-form" class="date-form">
            <label for="attendance-date">Select Date:</label>
            <input type="date" id="attendance-date" name="attendance-date" required>
            <button type="submit">Start Attendance</button>
        </form>
        <div id="result-message" style="margin-top:20px;"></div>
    </div>
    <script>
    document.getElementById('start-attendance-form').addEventListener('submit', async function(e) {
        e.preventDefault();
        const date = document.getElementById('attendance-date').value;
        const resultDiv = document.getElementById('result-message');
        resultDiv.textContent = "Starting attendance...";
        try {
            // Use HTTP, not HTTPS, since Flask dev server does not support HTTPS
            const response = await fetch('http://10.1.34.224:5600/start-attendance', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ date })
            });
            const result = await response.json();
            if (result.status === "success") {
                resultDiv.textContent = "Attendance started successfully!";
                resultDiv.className = "success";
            } else {
                resultDiv.textContent = result.message || "Failed to start attendance.";
                resultDiv.className = "error";
            }
        } catch (err) {
            resultDiv.textContent = "Error connecting to server.";
            resultDiv.className = "error";
        }
    });
    </script>
</body>
</html>